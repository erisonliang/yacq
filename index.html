<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Yacq : Yet Another Compilable Query Language for .NET" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>YACQ Project Home</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/takeshik/yacq">View on GitHub</a>

          <h1 id="project_title">YACQ</h1>
          <h2 id="project_tagline">Yet Another Compilable Query Language for .NET, based on Expression Trees API</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/takeshik/yacq/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/takeshik/yacq/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        

<h1>Welcome</h1>

<p>YACQ (pronounced as yacc) is an <strong>application-embeddable programming language for querying and scripting</strong>, runs on .NET platform.</p>

<h2>Features</h2>

<p>YACQ is a library that provides run-time scripting and querying for .NET applications. YACQ has the following features mainly:</p>

<ul>
<li>
<strong>Extension of Expression Trees API</strong>. YACQ is based on <a href="http://msdn.microsoft.com/library/bb397951.aspx">Expression Trees API</a>, a standard feature and one of basis of LINQ ecosystem. Since YACQ extends this and uses as its native syntax tree, YACQ fits with standard and other LINQ query providers.</li>
<li>
<strong>Language Services</strong>. YACQ can construct expression trees from source code string by <a href="https://github.com/linerlock/parseq">Parseq</a>, a monadic parser combinator. There are no way to construct expression trees from string in run-time (without external processes) in vanilla environments. You can modify and extend the grammar of YACQ.</li>
<li>
<strong>LINQ Support</strong>. YACQ contains wrapper class of querying interfaces such as <code>IQueryable&lt;T&gt;</code>. You can use (standard) query operators along with YACQ, in order to specify selectors, predicates, and other lambdas by code strings. Moreover, YACQ supports <a href="https://rx.codeplex.com/">Rx (Reactive Extensions) and Ix (Interactive Extensions)</a>.</li>
<li>
<strong>Extended Type System</strong>. YACQ not only can access to almost of .NET types, but also can extend the type system of .NET transparently. When you access to extension members, YACQ transforms to expression which is composed only of real member accesses. In short, YACQ can extend types without pollution of expression trees.</li>
<li>
<strong>Type Generator</strong>. Since the power of Expression Trees API, YACQ can compile codes to delegate or emits to static method builders, furthermore, YACQ also can define types with instance and static members, and output assemblies.</li>
<li>
<strong>Expression Tree Serializer</strong>. In vanilla environments, expression trees are not serializable. YACQ provides proxy types to support serialization. Proxy type describes the contents of the serialized expression tree more detailed and concisely than default <code>Expression.ToString()</code> outputs.</li>
</ul><h2>Usages</h2>

<p>Construct an expression tree from YACQ code string.</p>

<div class="highlight"><pre><span class="n">Expression</span> <span class="n">expr</span> <span class="p">=</span>
    <span class="n">YacqServices</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="s">"(+ 1 2 3)"</span><span class="p">);</span>
    <span class="c1">// same as ((1 + 2) + 3)</span>
</pre></div>

<p>Lambdas which has only one argument can construct easily by the helper method.</p>

<div class="highlight"><pre><span class="n">Expression</span><span class="p">&lt;</span><span class="n">Func</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;&gt;</span> <span class="n">lambda</span> <span class="p">=</span>
    <span class="n">YacqServices</span><span class="p">.</span><span class="n">ParseFunc</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;(</span><span class="s">"it.(ToUpper).(Replace 'FOO' 'bar')"</span><span class="p">);</span>
    <span class="c1">// same as (string it) =&gt; it.ToUpper().Replace("foo", "bar")</span>
</pre></div>

<p>Constructed lambdas can compile and evaluate by standard feature in run-time.</p>

<div class="highlight"><pre><span class="n">Func</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">func</span> <span class="p">=</span> <span class="n">lambda</span><span class="p">.</span><span class="n">Compile</span><span class="p">();</span>
<span class="n">func</span><span class="p">(</span><span class="s">"foooo"</span><span class="p">);</span> <span class="c1">// returns "barOO"</span>
</pre></div>

<p>You can use YACQ in LINQ queries.</p>

<div class="highlight"><pre><span class="kt">var</span> <span class="n">query</span> <span class="p">=</span> <span class="n">Enumerable</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">100</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Yacq</span><span class="p">()</span>
    <span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="s">"(== (% it 3) 0)"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">GroupBy</span><span class="p">(</span><span class="s">"(/ it 10)"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="s">"it.(Average)"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">OrderByDescending</span><span class="p">(</span><span class="s">"it"</span><span class="p">);</span>

<span class="c1">// Same as:</span>
<span class="n">Enumerable</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">100</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">it</span> <span class="p">=&gt;</span> <span class="n">it</span> <span class="p">%</span> <span class="m">3</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
    <span class="p">.</span><span class="n">GroupBy</span><span class="p">(</span><span class="n">it</span> <span class="p">=&gt;</span> <span class="n">it</span> <span class="p">/</span> <span class="m">10</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">it</span> <span class="p">=&gt;</span> <span class="n">it</span><span class="p">.</span><span class="n">Average</span><span class="p">())</span>
    <span class="p">.</span><span class="n">OrderByDescending</span><span class="p">(</span><span class="n">it</span> <span class="p">=&gt;</span> <span class="n">it</span><span class="p">);</span>
</pre></div>

<p>YACQ provides expression trees serializer. In vanilla environments, they are not serializable.</p>

<div class="highlight"><pre><span class="kt">string</span> <span class="n">xml</span> <span class="p">=</span> <span class="n">YacqServices</span><span class="p">.</span><span class="n">SaveText</span><span class="p">(</span><span class="n">lambda</span><span class="p">);</span>
<span class="n">Expression</span> <span class="n">lambda2</span> <span class="p">=</span> <span class="n">YacqServices</span><span class="p">.</span><span class="n">LoadText</span><span class="p">(</span><span class="n">xml</span><span class="p">);</span>
</pre></div>

<p>You can construct complex expression trees with YACQ-extended Expression Trees system.</p>

<div class="highlight"><pre><span class="n">Expression</span> <span class="n">expr2</span> <span class="p">=</span> <span class="n">YacqExpression</span><span class="p">.</span><span class="n">TypeCandidate</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Enumerable</span><span class="p">))</span>
    <span class="p">.</span><span class="n">Method</span><span class="p">(</span><span class="s">"Range"</span><span class="p">,</span> <span class="n">Expression</span><span class="p">.</span><span class="n">Constant</span><span class="p">(</span><span class="m">1</span><span class="p">),</span> <span class="n">Expression</span><span class="p">.</span><span class="n">Constant</span><span class="p">(</span><span class="m">100</span><span class="p">))</span>
    <span class="p">.</span><span class="n">Method</span><span class="p">(</span><span class="s">"Reverse"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Method</span><span class="p">(</span><span class="s">"Take"</span><span class="p">,</span> <span class="n">Expression</span><span class="p">.</span><span class="n">Constant</span><span class="p">(</span><span class="m">10</span><span class="p">))</span>
    <span class="p">.</span><span class="n">Method</span><span class="p">(</span><span class="s">"Sum"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Reduce</span><span class="p">();</span>

<span class="c1">// Same as:</span>
<span class="n">Expression</span><span class="p">.</span><span class="n">Call</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Enumerable</span><span class="p">),</span> <span class="s">"Sum"</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span>
    <span class="n">Expression</span><span class="p">.</span><span class="n">Call</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Enumerable</span><span class="p">),</span> <span class="s">"Take"</span><span class="p">,</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="k">typeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="p">},</span>
        <span class="n">Expression</span><span class="p">.</span><span class="n">Call</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Enumerable</span><span class="p">),</span> <span class="s">"Reverse"</span><span class="p">,</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="k">typeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="p">},</span>
            <span class="n">Expression</span><span class="p">.</span><span class="n">Call</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Enumerable</span><span class="p">),</span> <span class="s">"Range"</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">Expression</span><span class="p">.</span><span class="n">Constant</span><span class="p">(</span><span class="m">1</span><span class="p">),</span> <span class="n">Expression</span><span class="p">.</span><span class="n">Constant</span><span class="p">(</span><span class="m">100</span><span class="p">))</span>
        <span class="p">),</span> <span class="n">Expression</span><span class="p">.</span><span class="n">Constant</span><span class="p">(</span><span class="m">10</span><span class="p">)));</span>
</pre></div>

<p>Although the main use of YACQ is to embed in other applications, YACQ also can use in standalone. Complier frontend and REPL environment are bundled.</p>

<h2>Get Started</h2>

<p>To use YACQ, you have to refer <code>Yacq.dll</code> by your application. There are some way to get the system:</p>

<ul>
<li>
<strong><a href="http://nuget.org/packages/Yacq">Install NuGet package</a></strong>: If you only need the library, you can get and install it via NuGet.<br><code>
PM&gt; Install-Package Yacq
</code>
</li>
<li>
<strong><a href="http://yacq.net/download">Download binary archive</a></strong>: You can download the binary archive. This contains all libraries, executables, and documents. If you want compiler frontend or REPL environment, please download this.</li>
<li>
<strong><a href="https://github.com/takeshik/yacq">Download source code in GitHub</a></strong>: You can get the source codes in GitHub.

<ul>
<li>
<strong>Clone the repository</strong>: You can clone the Git repository.<br><code>
% git clone git://github.com/takeshik/yacq.git
</code>
</li>
<li>
<strong>Download snapshot</strong>: Snapshot archive of the repository is also available (<a href="https://github.com/takeshik/yacq/tarball/master">.tar.gz</a> | <a href="https://github.com/takeshik/yacq/zipball/master">.zip</a>).</li>
</ul>
</li>
</ul><h2>Prerequisites</h2>

<ul>
<li>Target Framework:

<ul>
<li>.NET Framework 4 or later</li>
<li>Silverlight 5</li>
<li>Mono 2.10 or later</li>
</ul>
</li>
<li>Library Dependencies

<ul>
<li>Reactive Extensions (<a href="http://nuget.org/packages/Rx-Main">Rx-Main</a>, <a href="http://nuget.org/packages/Rx-Providers">Rx-Providers</a>)</li>
<li>Interactive Extensions (<a href="http://nuget.org/packages/Ix_Experimental-Main">Ix_Experimental-Main</a>, <a href="http://nuget.org/packages/Ix_Experimental-Providers">Ix_Experimental-Providers</a>)</li>
<li><a href="http://nuget.org/packages/Parseq">Parseq</a></li>
</ul>
</li>
</ul><h2>Licensing</h2>

<p>Copyright © 2011-2013 Takeshi KIRIYA (aka takeshik) (<a href="http://www.takeshik.org/">Web</a> | <a href="mailto:takeshik_AT_yacq_DOT_net">Mail</a> | <a href="https://github.com/takeshik">GitHub</a> | <a href="https://twitter.com/takeshik">Twitter</a>), All rights reserved.</p>

<p>YACQ is <a href="http://www.gnu.org/philosophy/free-sw.html">Free Software</a>. Its source codes, binaries, and all other resources are licensed under the <a href="https://github.com/takeshik/yacq/blob/master/LICENSE.txt">MIT License</a>.</p>


      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Copyright © 2011-2013 Takeshi KIRIYA (aka takeshik), All rights reserved.</p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
